{% extends "base.html" %}

{% block title %}Patron Dashboard{% endblock %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patron Dashboard</title>
</head>
<body>
    {% load socialaccount %}
    <div class="container">
        {% if user.is_authenticated %}
            <!-- Patron Dashboard (For authenticated users) -->
            <center>
                <h2>
                    {% if user.profile.profile_picture %}
                    <img src="{{ user.profile.profile_picture.url }}" alt="{{ user.username }} profile" style="width:150px;">
                    {% endif %}
                    Welcome, {{ user.username.title }}! <small>(Patron)</small>
                </h2>
                <p>Email: {{ user.email }}</p>
                <a href="{% url 'search_home' %}" style="
                display: inline-block;
                margin: 10px 0 20px;
                padding: 10px 20px;
                background-color: #3498db;
                color: white;
                border-radius: 5px;
                text-decoration: none;
                font-weight: bold;
            ">🔍 Go to Search Page</a>
            </center>
            <h2>Dashboard</h2>
            <ul>
                <li><a href="{% url 'view_items' %}">📚 Browse Available Books</a></li>
                <li><a href="{% url 'view_collections' %}">📚 Browse Collections</a></li>
                <li><a href="#">📖 View Borrowed Books (Coming Soon)</a></li>
                <li><a href="#">📥 Request a Book (Coming Soon)</a></li>
                <li><a href="#">🔔 Notifications (Coming Soon)</a></li>
                <li><a href="{% url 'upload_profile_picture'%}">Upload profile picture</a></li>
            </ul>
            <center>
                <form method="POST" action="{% url 'request_librarian' %}">
                    {% csrf_token %}
                    <button type="submit" class="button-request">Request Librarian Status</button>
                </form>
                <a href="{% url 'logout' %}" class="button-logout">Logout</a>
            </center>
            {% if messages %}
                <div class="container mt-3">
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show text-center" role="alert" style="background-color: #f0f9ff; color: #155724; border-left: 5px solid #28a745; margin-bottom: 10px;">
                            <strong>{{ message }}</strong>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% else %}
            <h2>Guest View</h2>
            <p>Welcome, guest! You can browse available books and access some basic features.</p>
                <a href="{% url 'search_home' %}" style="
                display: inline-block;
                margin: 10px 0 20px;
                padding: 10px 20px;
                background-color: #3498db;
                color: white;
                border-radius: 5px;
                text-decoration: none;
                font-weight: bold;
            ">🔍 Go to Search Page</a>
            <ul>
                <li><a href="{% url 'view_items' %}">📚 Browse Available Books</a></li>
                <li><a href="{% url 'view_collections' %}">📚 Browse Collections</a></li>
                <li><a href="#">📖 View Borrowed Books (Login required)</a></li>
                <li><a href="#">📥 Request a Book (Login required)</a></li>
                <li><a href="#">🔔 Notifications (Login required)</a></li>
            </ul>
            <p>Please log in to access the full features.</p>
            <a href="{% provider_login_url 'google' %}?next=/redirect-after-login" class="btn btn-primary">Log In With Google</a>
        {% endif %}
        
        <footer>
            <p>This system is a class project. It is not monitored, and no real information should be submitted.</p>
        </footer>
    </div>
</body>
</html>
{% endblock %}