{% extends "base.html" %}
{% block title %}Borrow Requests{% endblock %}

{% block content %}
<div class="container my-5" style="max-width: 800px;">
  <h2 class="text-center text-primary mb-4">üì• Borrow Requests</h2>
  {% if user.is_authenticated %}
    <p class="text-center">Welcome, {{ user.get_full_name|default:user.username
  {% if requests %}
    <div class="table-responsive">
      <table class="table table-striped">
        <thead class="thead-dark">
          <tr>
            <th>Item</th>
            <th>Patron</th>
            <th>Requested At</th>
            <th>Status</th>
            <th>Due Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for req in requests %}
            <tr>
              <td>{{ req.item.title }}</td>
              <td>{{ req.patron.get_full_name|default:req.patron.username }}</td>
              <td>{{ req.requested_at|date:"M d, Y H:i" }}</td>
              <td>{{ req.get_status_display }}</td>
              <td>
                {% if req.due_date %}
                  {{ req.due_date|date:"M d, Y" }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>
                {% if req.status == "pending" %}
                  <a href="{% url 'approve_borrow_request' req.id %}" class="btn btn-sm btn-success">‚úÖ Approve</a>
                  <a href="{% url 'deny_borrow_request' req.id %}" class="btn btn-sm btn-danger ml-2">‚ùå Deny</a>
                {% else %}
                  <span class="text-muted">No actions</span>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="text-center text-muted">There are no borrow requests at this time.</p>
  {% endif %}
  <div class="text-center mt-4">
    <a href="{% url 'home' %}" class="btn btn-outline-primary">‚Üê Back to Dashboard</a>
  </div>
</div>
    </p>
  {% else %}
  <p>{{ error_message }}</p>
  <p><a href = "{% url 'home' %}">Go back to home</a></p>
  {% endif %}
{% endblock %}
